import mysql
from mysql.connector import Error


def create_db_connection():
    try:
        print("trying")

        # TODO Create ENV variables to handle database credentials in a correct way.
        # I think I need to use https://direnv.net/
        # db_host = env(DB_HOST, 'localhost')
        # db_port = env.int(DB_PORT, 3306)
        # db_user = env(DB_USER)
        # db_pass = env(DB_PASS)
        # db_name = env(DB_NAME)
        #
        # conn = pymysql.connect(db_host,db_user,db_pass,db_name, use_unicode=True, charset="utf8")



        connection = mysql.connector.connect(host='162.246.156.171',
                                             database='riverapp',
                                             user='riverapp',
                                             password='riverapp',
                                             auth_plugin='mysql_native_password')

        print("connection attempted")
        if connection.is_connected():
            db_Info = connection.get_server_info()
            print("Connected to MySQL Server version ", db_Info)
            cursor = connection.cursor()
            cursor.execute("select database();")
            record = cursor.fetchone()
            cursor.close()
            print(f"You're connected to database: {record}")
            return connection

    except Error as e:
        print("Error while connecting to MySQL", e)


def main():

    print('hello')
    db_connection = create_db_connection()

    if db_connection.is_connected():
        db_connection.close()
        print("MySQL connection is closed")


if __name__ == '__main__':
    main()